# firenvimã‚’ä½¿ã£ã¦Webã§ã‚‚vimã‚‹

ã“ã®è¨˜äº‹ã¯ [Vim Advent Calendar 2019 \- Qiita](https://qiita.com/advent-calendar/2019/vim) 14æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚

## firenvimã¨ã¯ï¼Ÿ
GitHub Repository: [glacambre/firenvim: Embed Neovim in your browser\.](https://github.com/glacambre/firenvim)

> Turn your browser into a Neovim client.

ã“ã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã¨ãƒ–ãƒ©ã‚¦ã‚¶ãŒNeovim clientã«æ—©å¤‰ã‚ã‚Šã—ã¾ã™ã€‚

ä»Šå›ã¯ãã®è¨­å®šæ‰‹é †ã¨è¨­å®šã—ãŸã‚‰ã©ã†ãªã‚‹ã®ã‹ï¼Ÿã¨ã„ã†ã“ã¨ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## è¨­å®šæ‰‹é †
### init.nvim ã®è¨˜è¿°
#### firenvim pluginã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
è©³ç´°ã¯ä»¥ä¸‹ã«è¨˜è¿°ã—ã¦ã‚ã‚Šã¾ã™ã€‚

[glacambre/firenvim#Pre-built](https://github.com/glacambre/firenvim#pre-built)

ã“ã“ã§ã¯ [junegunn/vim\-plug: Minimalist Vim Plugin Manager](https://github.com/junegunn/vim-plug) ã‚’åˆ©ç”¨ã—ãŸä¾‹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

```vim
Plug 'glacambre/firenvim', { 'do': { _ -> firenvim#install(0) } }
```

#### è¨­å®š
##### ã‚µã‚¤ãƒˆã”ã¨ã«ã©ã®è¦ç´ ã§firenvimã‚’èµ·å‹•ã™ã‚‹ã‹
å…¨ã¦ã®ã‚µã‚¤ãƒˆ(ãƒ›ã‚¹ãƒˆ)ã® `textarea` ã«ã¦firenvimã‚’èµ·å‹•ã™ã‚‹è¨­å®š
```vim
let g:firenvim_config = {
    \ 'localSettings': {
        \ '.*': {
            \ 'selector': 'textarea, div[role="textbox"]',
            \ 'priority': 0,
        \ }
    \ }
\ }
```

github.com ã®ã¿ `textarea` ã§firenvimãŒèµ·å‹•ã™ã‚‹è¨­å®š
```vim
let g:firenvim_config = {
    \ 'localSettings': {
        \ '.*': {
            \ 'selector': '',
            \ 'priority': 0,
        \ },
        \ 'github\.com': {
            \ 'selector': 'textarea',
            \ 'priority': 1,
        \ },
    \ }
\ }
```

ä¸Šè¨˜ã‚’å‚è€ƒã«ç‹¬è‡ªã®è¨­å®šã‚’ã©ã‚“ã©ã‚“è¿½åŠ ã—ã¦ã„ãã“ã¨ã‚‚ã‚‚ã¡ã‚ã‚“å¯èƒ½ã§ã™ã€‚

##### ãƒ†ã‚­ã‚¹ãƒˆä¿å­˜æ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ã®è¦ç´ ã¨åŒæœŸã™ã‚‹

```vim
let g:dont_write = v:false
function! My_Write(timer) abort
	let g:dont_write = v:false
	write
endfunction

function! Delay_My_Write() abort
	if g:dont_write
		return
	end
	let g:dont_write = v:true
	call timer_start(10000, 'My_Write')
endfunction

au TextChanged * ++nested call Delay_My_Write()
au TextChangedI * ++nested call Delay_My_Write()
```

##### ä»»æ„: ç‰¹å®šã‚µã‚¤ãƒˆã§filetypeã‚’è¨­å®šã™ã‚‹
ã›ã£ã‹ããƒ–ãƒ©ã‚¦ã‚¶ã‚’ Neovim ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãªã‚‰ Playground ãªã©ã§ç©æ¥µçš„ã«ä½¿ã„ãŸã„ã¨ã“ã‚ã§ã™ã€‚

ä¸‹ã®è¡¨ã®ã‚ˆã†ã« filetype ã‚’è¨­å®šã—ã¦ã„ãã¾ã™ã€‚

| ã‚µã‚¤ãƒˆ | filetype |
| :---: | :---: |
| [The Go Playground](https://play.golang.org/) | go |
| [Rust Playground](https://play.rust-lang.org/) | rust |
| [GitHub](https://github.com/) | markdown |

firenvim ã¯ `$HOME/.local/share/firenvim` ä»¥ä¸‹ã« `ãƒ›ã‚¹ãƒˆå_*.txt` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€æ™‚çš„ã«ä½œæˆã—ã€ãã‚Œã‚’æ‰±ã£ã¦ã„ãã¾ã™ã€‚

ãã®ãŸã‚ã€ä¸‹è¨˜ã®ã‚ˆã†ã«è¨˜è¿°ã™ã‚‹ã“ã¨ã§ã€firenvimã‚’åˆ©ç”¨ã—ãªãŒã‚‰ filetype ã‚’è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```vim
augroup Firenvim
  au BufEnter play.golang.org_*.txt set filetype=go
  au BufEnter play.rust-lang.org_*.txt set filetype=rust
  au BufEnter github.com_*.txt set filetype=markdown
augroup END
```

##### ä»»æ„: guifontã®è¨­å®š
æ™®æ®µç«¯æœ«ã®fontè¨­å®šã‚’ãã®ã¾ã¾åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§ãã®è¨­å®šãŒåæ˜ ã•ã‚Œã¾ã›ã‚“ã€‚

`guifont` ã‚’è¨­å®šã—ã¦ã€ãŠå¥½ããªfontã§ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§vimã‚Šã¾ã—ã‚‡ã†ã€‚

[Droid Sans Mono Slashed for Powerlines](https://github.com/powerline/fonts/blob/master/DroidSansMonoSlashed/Droid%20Sans%20Mono%20Slashed%20for%20Powerline.ttf) ã®fontã‚’åˆ©ç”¨ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚(font sizeã¯ 14 ã«ã—ã¾ã™)

```vim
let g:firenvim_font = 'Droid\ Sans\ Mono\ Slashed\ for\ Powerline'
function! Set_Font(font) abort
  execute 'set guifont=' . a:font . ':h14'
endfunction

augroup Firenvim
  au BufEnter github.com_*.txt set filetype=markdown | call Set_Font(g:firenvim_font)
  au BufEnter play.rust-lang.org_*.txt set filetype=rust | call Set_Font(g:firenvim_font)
  au BufEnter play.golang.org_*.txt set filetype=go |call Set_Font(g:firenvim_font)
augroup END
```

#### æœ€çµ‚çš„ãª `init.nvim`
```vim
let g:firenvim_config = {
  \ 'localSettings': {
    \ 'github\.com': {
      \ 'selector': 'textarea',
      \ 'priority': 0,
\       },
\     }
  \ }

let g:dont_write = v:false
function! My_Write(timer) abort
  let g:dont_write = v:false
  write
endfunction

function! Delay_My_Write() abort
  if g:dont_write
    return
  end
  let g:dont_write = v:true
  call timer_start(10000, 'My_Write')
endfunction


let g:firenvim_font = 'Droid\ Sans\ Mono\ Slashed\ for\ Powerline'
function! Set_Font(font) abort
  execute 'set guifont=' . a:font . ':h14'
endfunction

augroup Firenvim
  au TextChanged * ++nested call Delay_My_Write()
  au TextChangedI * ++nested call Delay_My_Write()
  au BufEnter github.com_*.txt set filetype=markdown | call Set_Font(g:firenvim_font)
  au BufEnter play.rust-lang.org_*.txt set filetype=rust | call Set_Font(g:firenvim_font)
  au BufEnter play.golang.org_*.txt set filetype=go |call Set_Font(g:firenvim_font)
augroup END
```

### æ‹¡å¼µã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
`init.nvim` ã«è¨­å®šã‚’åŠ ãˆã‚‹ä»–ã«ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

* Google Chrome: [Firenvim \- Chrome Web Store](https://chrome.google.com/webstore/detail/firenvim/egpjdkipkomnmjhjmdamaniclmdlobbo)
* FireFox: [Firenvim â€“ Get this Extension for ğŸ¦Š Firefox \(en\-US\)](https://addons.mozilla.org/en-US/firefox/addon/firenvim/)

## ãƒ‡ãƒ¢
### [The Go Playground](https://play.golang.org/) 
![.](https://github.com/cappyzawa/demo/blob/master/vim-advent-calendar-14/go-playground.png?raw=true)

### [Rust Playground](https://play.rust-lang.org/)
![.](https://github.com/cappyzawa/demo/blob/master/vim-advent-calendar-14/rust-playground.png?raw=true)

æ™®æ®µã®é–‹ç™ºã§LSP Clientã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚‚ã“ã®ã‚ˆã†ã«åˆ©ç”¨ã§ãã¾ã™ã€‚

### [GitHub](https://github.com/)
![.](https://github.com/cappyzawa/demo/blob/master/vim-advent-calendar-14/github-issue.png?raw=true)

## ã¾ã¨ã‚
ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ Neovim ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ [glacambre/firenvim: Embed Neovim in your browser\.](https://github.com/glacambre/firenvim) ã¨ãã®è¨­å®šã®ä»•æ–¹ã®ä¾‹ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚
